\documentclass{article}
\usepackage[top=25truemm,bottom=20truemm,left=20truemm,right=20truemm]{geometry}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{mathrsfs}
\usepackage{latexsym}
\usepackage{bm}
\usepackage[dvipdfmx]{graphicx}
\usepackage{physics}
\usepackage{braket}
\usepackage{float}

\usepackage{comment}

\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage[dvipdfmx]{hyperref}
\usepackage{pxjahyper}
\usepackage{url}

\theoremstyle{definition}
\newtheorem{dfn}{Definition}[section]
\newtheorem{prop}[dfn]{Proposition}
\newtheorem{lem}[dfn]{Lemma}
\newtheorem{thm}[dfn]{Theorem}
\newtheorem{cor}[dfn]{Corollary}
\newtheorem{rem}[dfn]{Remark}
%\newtheorem*{rem*}[dfn]{Remark}
\newtheorem{fact}[dfn]{Fact}


\title{Notes on symmetry and group theory}
\author{Ryota Masuki}
\date{\today}

\begin{document}
\maketitle

\section{Time-reversal and the representations of non-unitary group}
This section is based on the discussion in the textbook by Inui, et al~\cite{inui2012group}.

\subsection{Time-reversal operation}
If we define the time-reversal operator as
\begin{align}
  \theta = - i \sigma_y K = 
  \begin{pmatrix}
     & -1 \\
    1 &  \\
  \end{pmatrix}
  K,
\end{align}
where $K$ is the complex conjugate operator.

\subsection{Non-unitary group and corepresentations}
When the unitary operations $u_i, u_j, u_k$ satisfy $u_i u_j = u_k$, 
\begin{align}
  (\theta u_i) u_j = u_i (\theta u_j) = \theta u_k
\end{align}
\begin{align}
  (\theta u_i) (\theta u_j) = (-1)^N u_k,
\end{align}
where $N$ is the number of electrons. The magnetic group $\bar{G}$ can be written as
\begin{align}
  \bar{G} = G + \theta G,
\end{align}
where $G$ is the set of unitary symmetry operations (symmetry operations without time-reversal).

The corepresentations of the non-unitary group satisfy
\begin{align}
  u_1 u_2 \psi_k &= \sum_j \psi_j [D(u_1) D(u_2)]_{jk}
  \label{eq:corepresentation_u1u2}
  \\
  u a \psi_k &= \sum_j \psi_j [D(u) D(a)]_{jk}
  \label{eq:corepresentation_ua}
  \\
  au \psi_k &= \sum_j \psi_j [D(a) D^*(u)]_{jk}
  \label{eq:corepresentation_au}
  \\
  a_1 a_2 \psi_k &= \sum_j \psi_j [D(a_1) D^*(a_2)]_{jk},
  \label{eq:corepresentation_a1a2}
\end{align}
where $u, u_1, u_2$ are unitary operations and $a, a_1, a_2$ are anti-unitary operations in the group (We use this notation without explanation from here on).
Two corepresentations $D$ and $D'$ are defined to be equivalent if there is a matrix $T$ that satisfy
\begin{align}
  D'(u) &= T^{-1} D(u) T
  \label{eq:equiv_corep1}
  \\
  D'(a) &= T^{-1} D(a) T^*
  \label{eq:equiv_corep2}
\end{align}
Note that the relation Eqs. (\ref{eq:corepresentation_u1u2}) to (\ref{eq:corepresentation_a1a2}) is unchanged by the transformation Eq. (\ref{eq:equiv_corep1}) and (\ref{eq:equiv_corep2}).

\subsection{Construction of the corepresentations}
Here, we consider how to construct the corepresentations of $\bar{G}$ from the representations of its unitary part $G$.
We first start from an irreducible representation and a basis of $G$
\begin{align}
  u \psi_k = \sum_{j = 1}^d \Delta_{jk}(u).
\end{align}
Here, we define 
\begin{align}
  \psi'_k = a_0 \psi_k.
\end{align}
We call the linear space spanned by the set $\{\psi_k\}_k$ as $H$ and the space spanned by $\{\psi'_k\}_k$ as $H'$.
If we write the transformation of $\psi'$ as
\begin{align}
  u \psi'_k = \sum_j \psi'_j \bar{\Delta}_{jk}(u),
\end{align}
$\bar{\Delta}$ satisfies
\begin{align}
  \bar{\Delta}_{jk} = \Delta^*_{jk} (a_0^{-1} u a_0).
\end{align}
This is because
\begin{align}
  a_0^{-1} u a_0 \psi_k 
  &= 
  a_0^{-1}
  \sum_j
  \Bigl(
    \psi'_j \bar{\Delta}_{jk}(u)  
  \Bigr)
  \nonumber
  \\&=
  \sum_j \psi_j \bar{\Delta}^*_{jk}(u)  
\end{align}
Note that $\bar{\Delta}$ is an irreducible representation of $G$ as well.

\subsubsection{The case that $\Delta$ and $\bar{\Delta}$ are equivalent}
We first investigate the case that $\Delta$ and $\bar{\Delta}$ are equivalent.
We assume that $\bar{\Delta}(u) = \Delta^*(a_0^{-1} u a_0) = U^{-1} \Delta(u) U$, and introduce a new basis
\begin{align}
  \psi'_k = \sum_j \varphi'_j U_{jk}.
\end{align}
In this section, we proceed in a mathematical fashion because the discussion is somewhat complicated.
We first clarify our assumptions.
\begin{dfn}[Starting point: $\Delta$ and $U$]\label{dfn:starting_point}~\\
  We assume that $\Delta$ and $\bar{\Delta}$ defined in the last section are equivalent by the transformation $\bar{\Delta}(u) = \Delta^*(a_0^{-1} u a_0) = U^{-1} \Delta(u) U$.
  Then, by taking an appropriate basis  $\psi_k \in H$ and $\varphi'_k \in H'$,
\begin{align}
  u \psi_k &= \psi_j \Delta_{jk} (u)
  \label{eq:upsi}
  \\
  u \varphi'_k &= \varphi'_j \Delta_{jk}(u)
  \label{eq:uvarphiprime}
  \\
  a_0 \psi_k &= \varphi'_j U_{jk}
  \label{eq:a0psi}
\end{align}
Eqs. (\ref{eq:upsi}) and (\ref{eq:uvarphiprime}) defines the mappings $u: H \to H$, $u: H' \to H'$ respectively.
Eq. (\ref{eq:a0psi}) defines the mapping $a_0: H\to H'$.
\end{dfn}

\begin{prop}[$a_0 : H' \to H$]\label{prop:a_0Hprime_H}~\\
  If we define $a_0 : H' \to H$ by 
  \begin{align}
    a_0 \varphi'_k = \psi_j (\Delta (a_0^2) (U^{-1})^*)_{jk} = \psi_j (\Delta (a_0^2) U^{T})_{jk},
    \label{eq:a0varphi_prime}
  \end{align}
  the condition
  \begin{align}
    a_0(a_0 \psi_k) = a_0^2 \psi_k. 
    \label{eq:a02_psi}
  \end{align}
  is satisfied.
\end{prop}

\begin{proof}
  We calculate the LHS and RHS of Eq. (\ref{eq:a02_psi}) separately.
  \begin{align}
    \text{(LHS)} = a_0 (\varphi'_j U_{jk}) = (a_0 \varphi') U^*,
  \end{align}
  \begin{align}
    \text{(RHS)} = a_0 (\varphi'_j U_{jk}) = \psi \Delta(a_0^2).
  \end{align}
  Comparing them, we get the proposition.
\end{proof}

Next, we investigate the inverse of $a_0$. 

\begin{prop}[$a_0^{-1} : H' \to H$]\label{prop:a01_Hprime_H}~\\
  If $a_0^{-1} : H' \to H$ is defined by
  \begin{align}
    a_0^{-1} \varphi'_k = \psi_j (U^{-1})^*_{jk} = \psi_j (U^{T})_{jk}, 
    \label{eq:inversea0_varphi}
  \end{align}
  $a_0^{-1} (a_0 \psi_k) = \psi_k$ is satisfied.
\end{prop}
\begin{proof}
  Easy calculation.
\end{proof}

\begin{prop}[$a_0^{-1} : H \to H'$]\label{prop:a01_H_Hprime}~\\
  If $a_0^{-1} : H \to H$' is defined by
  \begin{align}
    a_0^{-1} \psi_k = \varphi'_j (U \Delta(a_0^{-2})^*)_{jk} = \varphi'_j (U \Delta^T(a_0^{2}))_{jk}, 
    \label{eq:inversea0_varphi_HHprime}
  \end{align}
  $a_0^{-1} (a_0 \varphi'_k) = \varphi'_k$ is satisfied.
\end{prop}
\begin{proof}
  Easy calculation.
\end{proof}

\begin{thm}[Consistency of $u: H\to H$ and $u: H'\to H'$]\label{thm:Consistency_HHprime}~\\
  In order for 
  \begin{align}
    (a_0^{-1} u a_0 ) \psi = a_0^{-1}(u (a_0 \psi)).
    \label{eq:consistency_transf_HHprime}
  \end{align}
  to be satisfied, $\Delta$ and $U$ should satisfy 
  \begin{align}
    \Delta(a_0^{-1} u a_0) = (U^{-1})^* \Delta(u)^* U^*.
    \label{eq:Delta_am1ua}
  \end{align}
\end{thm}
\begin{proof}
  We start from Eq. (\ref{eq:consistency_transf_HHprime}).
  \begin{align}
    \text{(LHS)} = \psi_j \Delta_{jk}(a_0^{-1} u a_0).
  \end{align}
  Using Proposition~\ref{prop:a01_Hprime_H},
  \begin{align}
    \text{(RHS)} &= 
    a_0^{-1} u (\varphi'_j U_{jk}) 
    \nonumber
    \\&
    = a_0^{-1} (\varphi'_j (\Delta(u)U)_{jk})
    \nonumber
    \\&=
    \psi_j [(U^{-1})^* \Delta(u)^* U^*]_{jk}.
  \end{align}
  Therefore, we get
  \begin{align}
    \Delta(a_0^{-1} u a_0) = (U^{-1})^* \Delta(u)^* U^*.
  \end{align}
\end{proof}

Let me here summarize the results so far.
We started from Definition~\ref{dfn:starting_point} and got the formulas summarized in Table~\ref{table:operations_and_corep}.
The summrized formulas satisfy $a_0(a_0 \psi_k) = a_0^2 \psi_k$ (Proposition~\ref{prop:a_0Hprime_H}), 
$a_0^{-1} (a_0 \psi_k) = \psi_k$ (Proposition~\ref{prop:a01_Hprime_H}), and   $a_0^{-1} (a_0 \varphi'_k) = \varphi'_k$ (Proposition~\ref{prop:a01_H_Hprime}).
In addition, we proved that $\Delta(a_0^{-1} u a_0) = (U^{-1})^* \Delta(u)^* U^*$ is necessary for $(a_0^{-1} u a_0 ) \psi = a_0^{-1}(u (a_0 \psi))$ (Theorem~\ref{thm:Consistency_HHprime}).
\begin{table}[H]
  \label{table:operations_and_corep}
  \begin{center}
    \caption{Construction of the corepresentation.} 
\begin{tabular}{c|c}
  symmetry operation & operation on the basis \\
  \hline
  $u: H\to H$ & $u \psi_k = \psi_j \Delta_{jk} (u)$ \\
  $u: H'\to H'$ & $u \varphi'_k = \varphi'_j \Delta_{jk}(u)$ \\
  $a_0: H \to H'$ & $a_0 \psi_k = \varphi'_j U_{jk}$\\
  $a_0: H' \to H$ & $a_0 \varphi'_k = \psi_j (\Delta (a_0^2) (U^{-1})^*)_{jk} = \psi_j (\Delta (a_0^2) U^{T})_{jk}$\\
  $a_0^{-1}: H' \to H$ & $a_0^{-1} \varphi'_k = \psi_j (U^{-1})^*_{jk} = \psi_j (U^{T})_{jk}$\\
  $a_0^{-1}: H \to H'$ & $a_0^{-1} \psi_k = \varphi'_j (U \Delta(a_0^{-2})^*)_{jk} = \varphi'_j (U \Delta^T(a_0^{2}))_{jk}$
 \end{tabular}
\end{center}
\end{table}

Now, we prove that the above formulas and Theorem~\ref{thm:Consistency_HHprime} is sufficient to define a consistent corepresentation.

\begin{lem}~\\
  Assume that $u,v \in G$ satisfy $u a_0 = a_0 v$. Then, we can show that
  \begin{align}
    u (a_0 \psi_k) = a_0 (v \psi_k).
  \end{align}
\end{lem}

\begin{proof}
  Note that $v = a_0^{-1} u a_0$. If Eq. (\ref{eq:Delta_am1ua}) is satisfied (Theorem~\ref{thm:Consistency_HHprime}), we have
  \begin{align}
    a_0 v \psi_k 
    &= 
    a_0 (a_0^{-1} u a_0)\psi_k
    \nonumber
    \\&=
    a_0 (a_0^{-1} (u (a_0\psi_k))).
  \end{align}
  Using Eq. (\ref{eq:inversea0_varphi}), the last line can be rewritten as $u (a_0\psi_k)$. Thus, we get $u (a_0 \psi) = a_0 (v \psi)$.
\end{proof}
 

\begin{enumerate}  
  \item $a_0^2 \varphi' = a_0 (a_0 \varphi')$.\\
  When Eq. (\ref{eq:a0varphi_prime}) is satisfied, we get 
  \begin{align}
    a_0^2 \psi = a_0 (a_0 \psi).
    \label{eq:a02psi}
  \end{align} 
  In addition, we get $a_0^2 \psi = a_0^{-1} (a_0^2 (a_0 \psi))$ by substituting $u=a_0$ to Eq (\ref{eq:consistency_transf_HHprime}). Because the mapping from $H'$ to $H$ by $a_0^{-1}$ is defined as the inverse of $a_0$ [Eq. (\ref{eq:inversea0_varphi})], we get 
  \begin{align}
    a_0(a_0^2 \psi) =  a_0^2 (a_0 \psi).
  \end{align}
  Using Eq. (\ref{eq:a02psi}), we get 
  \begin{align}
    a_0(a_0(a_0 \psi)) =  a_0^2 (a_0 \psi).
  \end{align}
  Because $a_0 \psi$ spans a basis in $H'$, we get $a_0(a_0 \varphi') =  a_0^2 \varphi'$.
  \item When $u a_0 = a_0 v$, $u (a_0 \varphi') = a_0 (v \varphi')$.\\
  As $a_0 \varphi'$ spans a basis in $H$, we get
  \begin{align}
    u (a_0 (a_0 \varphi'_k)) = a_0 (v(a_0 \varphi'_k))
  \end{align}
  from Eq. (\ref{eq:consistency_transf_HHprime}). Using Eq. (\ref{eq:a02psi}) to the LHS, we get $u a_0^2 \varphi'_k$. Multiplying $a_0^{-2}$ from the left, 
  \begin{align}
    a_0^{-2} (\text{LHS}) &= a_0^{-2} (u a_0^{-2} \varphi')
    \nonumber
    \\&=
    (a_0^{-2} u a_0^{-2}) \varphi'
    \nonumber
    \\&=
    (a_0^{-1} (a_0^{-1} u a_0^{-1}) a_0)\varphi'
    \nonumber
    \\&=
    (a_0^{-1} v a_0)\varphi'
  \end{align}
  On the other hand,
  \begin{align}
    a_0^{-2} (\text{RHS}) 
    &=
    a_0^{-2} (a_0 (v(a_0 \varphi')))
    \nonumber
    \\&=
    a_0 (a_0^{-2} (v(a_0 \varphi')))
    \nonumber
    \\&=
    a_0 (a_0^{-1} (a_0^{-1} (v(a_0 \varphi'))))
    \\&=
    a_0^{-1} (v(a_0 \varphi'))
  \end{align}
  From the first to the second line, we used the special case of $u (a_0 \psi) = a_0 (v \psi)$ (Note that $v(a_0 \varphi')) \in H$).
  From the second to the third line, we use the inverse of Eq. (\ref{eq:a02_psi}). Note that we define the mapping $a_0^{-1}: H \to H'$ as the inverse of $a_0: H' \to H$.
  Thus, we get
  \begin{align}
    (a_0^{-1} v a_0)\varphi' = a_0^{-1} (v(a_0 \varphi'))
  \end{align}
  $u (a_0 \varphi') = a_0 (v \varphi')$ can be proven in a similar way as $u (a_0 \psi) = a_0 (v \psi)$
  \item For arbitrary $g_1, g_2 \in \bar{G}$, $(g_1 g_2) \psi = g_1 (g_2 \psi)$, $(g_1 g_2) \varphi' = g_1 (g_2 \varphi')$.\\
  It can be proven by combining the above lemmas.


\end{enumerate}







\bibliographystyle{unsrt}
\bibliography{reference}
\end{document}